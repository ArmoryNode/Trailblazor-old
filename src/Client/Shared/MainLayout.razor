@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication

@inject NavigationManager Navigation
@inject SignOutSessionStateManager SignOutManager

@inherits LayoutComponentBase

@attribute [Authorize]

<div id="wrapper">
    <nav id="sidebar">
        <div class="site-icon"><i class="fa-duotone fa-person-hiking"></i></div>
        <span class="category-title">Pages</span>
        <NavLink class="site-nav-link" href="/gear"><i class="fa-light fa-fw fa-clipboard-list fa-lg"></i>Gear</NavLink>
        <NavLink class="site-nav-link" href="/counter"><i class="fa-light fa-fw fa-backpack fa-lg"></i>Packs</NavLink>

        <div id="sidebar-menu">
            <AuthorizeView>
                <Authorized>
                    <AccountPartial />
                    <button class="site-nav-link btn btn-link" @onclick="BeginSignOut"><i class="fa-regular fa-fw fa-power-off"></i>Logout</button>
                </Authorized>
                <NotAuthorized>
                    <a class="site-nav-link" href="authentication/login"><i class="fa-light fa-fw fa-arrow-right-to-bracket"></i>Login</a>
                </NotAuthorized>
            </AuthorizeView>
        </div>
    </nav>
    <main id="content">
        @Body
    </main>
</div>

@code {
    private async Task BeginSignOut(MouseEventArgs args)
    {
        await SignOutManager.SetSignOutState();
        Navigation.NavigateTo("authentication/logout");
    }
}